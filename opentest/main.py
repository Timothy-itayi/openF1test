from flask import Flask, render_template
from helpers import get_f1_data, get_current_standing

app = Flask(__name__)

@app.route("/")
def index():

    # Fetch current standings for 2024 season
    current_standing = get_current_standing("8ac404c1-7494-4b04-b8a6-ee97913de526")

    
    # Render the index.html template
    return render_template('layout.html', standings=current_standing)


@app.route('/drivers')
def drivers():

    # Fetch data for driver number 44 (Lewis Hamilton)
    driver_data = get_f1_data(44)
    drivers = []

    if driver_data is not None and isinstance(driver_data, list):
        # Iterate over each driver dictionary in the list
        for driver in driver_data:
            # Extract relevant information from each driver dictionary
            driver_info = {'name': driver.get('full_name', ''), 'team': driver.get('team_name', ''),  'number': driver.get('driver_number', '')}
            drivers.append(driver_info)

    return render_template('drivers.html', drivers=drivers)

if __name__ == "__main__":
    app.run(host="127.0.0.1", port=8080, debug=True)